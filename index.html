<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Who's Driving?</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Styles -->
    <style type="text/css">
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto",
          "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans",
          "Helvetica Neue", sans-serif;
        font-size: 112.5%;
        max-width: 40em;
        width: 88%;
        margin-left: auto;
        margin-right: auto;
      }

      /**
			 * Form styles
			 */

      label,
      input {
        display: block;
        width: 100%;
      }

      .driver {
        list-style: none;
      }
    </style>
  </head>

  <body>
    <h1>Who's Driving?</h1>

    <div id="app"></div>

    <form id="add-driver">
      <label for="driver-name"
        >Add a name to the list of possible drivers</label
      >
      <input type="text" id="driver-name" />
      <button>Add a Driver</button>
    </form>

    <p>
      <button id="pick-driver">Pick a Driver</button>
      <button id="clear-drivers">Remove All Drivers</button>
    </p>

    <script src="component.js"></script>
    <script>
      // Code goes here...
      /*!
       * Sanitize and encode all HTML in a user-submitted string
       * (c) 2018 Chris Ferdinandi, MIT License, https://gomakethings.com
       * @param  {String} str  The user-submitted string
       * @return {String} str  The sanitized string
       */
      var sanitizeHTML = function (str) {
        var temp = document.createElement("div");
        temp.textContent = str;
        return temp.innerHTML;
      };

      /**
       * Methods
       */

      var app = new Component("#app", {
        data: {
          drivers: ["Pinky", "Bablu", "Chintu"],
          selected: "Chintu",
        },
        template: function (props) {
          //Check if there are drivers in the list
          if (props.drivers.length < 1) {
            return "<p><em> Add drivers to the list using the form given below.</em></p>";
          }

          var selected = "";
          if (props.selected) {
            selected =
              "<p><strong>" + props.selected + " is driving.<strong></p>";
          }

          // Create the list of drivers
          return (
            "<ul>" +
            props.drivers
              .map(function (driver, index) {
                var name = sanitizeHTML(driver);
                return (
                  "<li class= driver>" +
                  name +
                  ' <button aria-label="Remove ' +
                  name +
                  '" data-driver="' +
                  index +
                  '">remove</button></li>'
                );
              })
              .join("") +
            "</ul>" +
            selected
          );
        },
      });

      var submitHandler = function (event) {
        //if the target is not the form
        if (event.target.id !== "add-driver") return;

        // prevent form from submitting
        event.preventDefault();

        // check if there's input
        var input = document.querySelector("#driver-name");
        if (!input || input.value.length < 1) return;

        // get data from app & update it
        var appData = app.getData();
        appData.drivers.push(input.value);
        app.setData({ drivers: appData.drivers });

        // empty input field
        input.value = "";
        input.focus();
      };

      /**
       * Inits & event listeners
       */

      document.addEventListener("submit", submitHandler, false);

      // render the app
      app.render();
    </script>
  </body>
</html>
